<html>
	<div class="container-fluid">
		<h1><%=t :dashboard %> </h1>

		<ul class="nav nav-tabs">
			<% if @is_admin or @organizer.adminrights & 1 != 0 %> <!--check privileges to edit info-->
				<li role="presentation"><%= link_to t("Edit_tournament_info"),edit_tournament_path(@tournament) %></li>
			<% end %>

			<% if @is_admin or @organizer.adminrights & 4 != 0 %> <!--check privileges to add tournament admins-->
				<li role="presentaiton"><%= link_to t("Add_tournament_admin"), new_tournament_organizer_path %></li>
			<% end %>
	
			<% if @is_admin or @organizer.adminrights & 8 != 0 %> <!--check privileges to delete tournament-->
				<li role="presentation"><%= link_to t("Delete tournament"), tournament_path(@tournament),
				method: :delete,
				data: {confirm: 'Are you sure? Deleting this tournament will also delete all players, teams, sponsors, tournament organizers, and tickets associated with it.'} %></li>
			<% end %>
			
			<% if @is_admin or @organizer.adminrights & 1 != 0 %>
				<li role="presentation"><%= link_to t("View Players"), view_players_path(@tournament) %></li>
			<% end %>
			
			<% if @is_admin or @organizer.adminrights & 1 != 0 %>
				<li role="presentation"><%= link_to t("View Sponsors"), view_sponsors_path(@tournament) %></li>
			<% end %>
			
			<% if @is_admin or @organizer.adminrights & 1 != 0 %>
				<li role="presentation"><%= link_to t("View Tournament Organizers"), view_tournament_organizers_path(@tournament) %></li>
			<% end %>
		</ul>
	</div>

	<%= render partial: "tournaments/tournament_info" %>

	<% if @is_admin or @organizer.adminrights & 2 != 0 %> <!--check privileges to manage tee sheets-->
	<div class="container-fluid">
		<h2>
			Current Teamless Players
		</h2>
		<% teamless_players = @tournament.players.select{|p| p.team_id == nil } %>
		<% teams_needed = (teamless_players.length / 4.to_f).ceil + @full_teams %>
		
		<%= form_tag ("/tournaments/#{@tournament.id}/create_new_teams_for_tournament") do %>
			<table class="table">
				<th>First Name</th>
				<th>Last Name</th>
				<th>Add to Team Number:</th>
				<th colspan="3"></th>
				<% teamless_players.each do |tp|%>
					<tr>
						<td><%= tp.person.firstname %></td>
						<td><%= tp.person.lastname %></td>
						<td><%= number_field_tag "teams_selected[#{tp.id}]", nil, min: @full_teams+1, max: teams_needed, step: 1 %></td>
					</tr>
				<% end %>
			</table>
			<% if(teamless_players.empty? == false)%>
				<%= submit_tag "Add to Team" %>
			<% end %>
		<% end %>
	<% end %>
	</div>

</html>
